

### 共享锁
**共享锁，又称为读锁，获得共享锁之后，可以查看但无法修改和删除数据。**
<br>就是我们对数据进行读取操作的时候，其实是不会改变数据的值的。
<br>
所以我们可以给数据库增加读锁，获得读锁的事务就可以读取数据了。当数据库已经被别人增加了读锁的时候，其他新来的事务也可以读数据，但是不能写。
<br>
也就是说，如果事务T对数据A加上共享锁后，则其他事务只能对A再加共享锁，不能加排他锁。获准共享锁的事务只能读数据，不能修改数据。
#### 用法
在查询语句后面增加LOCK IN SHARE MODE，Mysql会对查询结果中的每行都加共享锁。
```
SELECT ... LOCK IN SHARE MODE;
```

当没有其他线程对查询结果集中的任何一行使用排他锁时，可以成功申请共享锁，否则会被阻塞。其他线程也可以读取使用了共享锁的表，而且这些线程读取的是同一个版本的数据。

### 排他锁
**排他锁，又称为写锁、独占锁。获准排他锁后，既能读数据，又能修改数据。**
<br>
就是我们对数据进行写操作的时候，要先获得写锁，获得写锁的事务既可以写数据也可以读数据。当时，如果数据库已经被别人增加了排他写锁，那么后面的事务是无法在获得该数据库的任何锁的。

也就是说，如果事务T对数据A加上排他锁后，则其他事务不能再对A加任任何类型的封锁。获准排他锁的事务既能读数据，又能修改数据。

#### 用法
在查询语句后面增加FOR UPDATE，Mysql会对查询结果中的每行都加排他锁


```
SELECT ... FOR UPDATE;
```

当没有其他线程对查询结果集中的任何一行使用排他锁时，可以成功申请排他锁，否则会被阻塞。

###  加锁原则
拿MySql的InnoDB引擎来说，对于insert、update、delete等操作。会自动给涉及的数据加排他锁；

对于一般的select语句，InnoDB不会加任何锁，事务可以通过以下语句给显示加共享锁或排他锁。

共享锁：SELECT ... LOCK IN SHARE MODE;

排他锁：SELECT ... FOR UPDATE;

